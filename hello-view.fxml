<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Region?>

<VBox spacing="25.0" xmlns:fx="http://javafx.com/fxml"
      fx:controller="org.example.pharmacymanagementsystem.HelloController"
      stylesheets="@styles.css" styleClass="root">
    <padding>
        <Insets bottom="20.0" left="25.0" right="25.0" top="20.0"/>
    </padding>

    <!-- Header -->
    <HBox alignment="CENTER" styleClass="header-bar">
        <VBox>
            <Label text="Pharmacist Dashboard" styleClass="header-title"/>
            <Label text="Point of Sale &amp; Customer Management" styleClass="sub-header-title"/>
        </VBox>
        <Region HBox.hgrow="ALWAYS"/>
        <VBox alignment="CENTER_RIGHT">
            <Label fx:id="userLabel" style="-fx-font-weight: bold; -fx-text-fill: #3498db;"/>
            <Label fx:id="dateTimeLabel" style="-fx-text-fill: #95a5a6; -fx-font-size: 12px;"/>
        </VBox>
        <Button text="Logout" onAction="#onLogoutClick" styleClass="button-danger" style="-fx-margin-left: 20;"/>
    </HBox>

    <TabPane fx:id="mainTabPane" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">
        <tabs>
            <Tab text="Sales (POS)">
                <VBox spacing="20">
                    <padding><Insets top="25" right="5" bottom="5" left="5"/></padding>

                    <HBox spacing="20" VBox.vgrow="ALWAYS">
                        <!-- Left Side: Sale Form & Table -->
                        <VBox spacing="20" HBox.hgrow="ALWAYS">
                            <VBox styleClass="card" spacing="15">
                                <HBox alignment="CENTER_LEFT">
                                    <Label text="New Transaction" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                    <Region HBox.hgrow="ALWAYS"/>
                                    <Label fx:id="stockWarningLabel" style="-fx-font-weight: bold;"/>
                                </HBox>
                                <HBox spacing="15" alignment="CENTER_LEFT">
                                    <ComboBox fx:id="saleMedicineCombo" promptText="Select Medicine" onAction="#onMedicineSelected" prefWidth="250"/>
                                    <ComboBox fx:id="saleCustomerCombo" promptText="Select Customer" prefWidth="200"/>
                                    <TextField fx:id="saleQtyField" promptText="Qty" prefWidth="80"/>
                                </HBox>
                                <HBox spacing="15" alignment="BOTTOM_LEFT">
                                    <TextField fx:id="doctorNameField" promptText="Doctor Name (for Rx)" HBox.hgrow="ALWAYS"/>
                                    <Button text="Add to Bill" onAction="#onAddToBillClick" styleClass="button-success"/>
                                </HBox>
                            </VBox>

                            <TableView fx:id="saleTable" VBox.vgrow="ALWAYS"/>
                        </VBox>

                        <!-- Right Side: Drug Info Panel -->
                        <VBox styleClass="card" prefWidth="320" spacing="15">
                            <Label text="Drug Information (FDA)" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #3498db;"/>
                            <Label fx:id="drugInfoTitle" style="-fx-font-style: italic; -fx-font-weight: bold;"/>
                            <TextArea fx:id="drugInfoArea" wrapText="true" editable="false" VBox.vgrow="ALWAYS"/>
                            <Label text="Source: openFDA" style="-fx-font-size: 10px; -fx-text-fill: #bdc3c7;"/>
                        </VBox>
                    </HBox>
                </VBox>
            </Tab>

            <Tab text="My Daily Sales">
                <VBox spacing="20">
                    <padding><Insets top="25" right="5" bottom="5" left="5"/></padding>
                    <VBox styleClass="card">
                        <Label text="My Sales Report (Today)" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                        <Label fx:id="myDailyTotalLabel" style="-fx-font-size: 18px; -fx-text-fill: #2ecc71; -fx-font-weight: bold;"/>
                    </VBox>
                    <TableView fx:id="mySalesTable" VBox.vgrow="ALWAYS"/>
                </VBox>
            </Tab>

            <Tab text="Customers">
                <VBox spacing="20">
                    <padding><Insets top="25" right="5" bottom="5" left="5"/></padding>

                    <VBox styleClass="card" spacing="15">
                        <Label text="Register New Customer" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                        <HBox spacing="15">
                            <TextField fx:id="custNameField" promptText="Full Name" HBox.hgrow="ALWAYS"/>
                            <TextField fx:id="custContactField" promptText="Contact Number"/>
                            <TextField fx:id="custAgeField" promptText="Age" prefWidth="80"/>
                            <ComboBox fx:id="custGenderCombo" promptText="Gender" prefWidth="120"/>
                        </HBox>
                        <HBox spacing="15" alignment="BOTTOM_LEFT">
                             <TextField fx:id="custAddressField" promptText="Full Address" HBox.hgrow="ALWAYS"/>
                            <Button text="Add Customer" onAction="#onAddCustomerClick" styleClass="button-success"/>
                        </HBox>
                    </VBox>

                    <TableView fx:id="customerTable" VBox.vgrow="ALWAYS"/>
                </VBox>
            </Tab>
        </tabs>
    </TabPane>
</VBox>
